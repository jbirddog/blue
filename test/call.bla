
include "../tools/bth/bth.inc"

test

litw	'11'
plan

;
; test calling bytecode
;

comp
	ok
endcomp
call

comp
	comp
		ok
	endcomp
	call
endcomp
call

comp
	comp
		comp
			ok
		endcomp
		call
	endcomp
	call
endcomp
call

comp
	comp
		comp
			comp
				ok
			endcomp
			call
		endcomp
		call
	endcomp
	call
endcomp
call

comp
	comp
		comp
			comp
				comp
					ok
				endcomp
				call
			endcomp
			call
		endcomp
		call
	endcomp
	call
endcomp
call

comp
	comp
		comp
			comp
				comp
					comp
						ok
					endcomp
					call
				endcomp
				call
			endcomp
			call
		endcomp
		call
	endcomp
	call
endcomp
call

litb 0x01
litb 0x02
comp
	add
endcomp
call

litb 0x03
okeq

litb 0x04
litb 0x05
comp
	comp
		comp
			add
		endcomp
		call
	endcomp
	call
endcomp
call

litb 0x09
okeq

litb 0x01
comp
	litb 0x03
	eq
	comp
		comp
			notok
		endcomp
		comp
			ok
		endcomp
		ifelse
	endcomp
	call
endcomp
call

start
litw	0x0800
add
dup
sethere

litb	ok.code
cb

litb	ret.code
cb

call

ib
dup
sethere

litb	ok.code
cb

litb	ret.code
cb

call

done
