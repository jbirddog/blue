import sys

global _start

: buf.cap ( -- ) 1024 ; inline

section .bss

\ TODO resolve run issue with using buf.cap below
1024 resb buf

section .text

: orexit ( result:eax -- value:eax ) dup 0 cmp ' exit.syserr xl ;

: buf.read ( -- buf:esi read:eax ) buf buf.cap read.stdin orexit ;
: buf.write ( buf:esi len:edx -- wrote:eax ) write.stdout orexit ;

\ TODO also still a bit loose with effect handling as seen with exit
: _start ( -- noret ) buf.read buf.write 0 exit ; 
