import sys

global _start

1024 const buf.cap

buf.cap resb buf

: orexit ( result:eax -- value:eax ) dup 0 cmp ' exit.syserr xl ;

: buf.read ( -- buf:esi read:eax ) buf buf.cap read.stdin orexit ;
: buf.write ( buf:esi len:edx -- wrote:eax ) write.stdout orexit ;

\ TODO also still a bit loose with effect handling as seen with exit
: _start ( -- noret ) buf.read buf.write 0 exit ; 
